<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>EventLogs on Owlglass</title>
    <link>https://kdbed.github.io/tags/eventlogs/</link>
    <description>Recent content in EventLogs on Owlglass</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <atom:link href="https://kdbed.github.io/tags/eventlogs/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Account Lockout - Splunk</title>
      <link>https://kdbed.github.io/posts/account_lockout_splunk/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://kdbed.github.io/posts/account_lockout_splunk/</guid>
      <description>&lt;p&gt;Monitoring &lt;a href=&#34;https://kdbed.github.io/posts/active_directory/&#34;&gt;Active Directory&lt;/a&gt; account lockouts with &lt;a href=&#34;https://kdbed.github.io/posts/splunk/&#34;&gt;Splunk&lt;/a&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;index=wineventlog Account_Name=&amp;lt;&amp;lt;accountNameHere&amp;gt;&amp;gt;&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(EventCode=4740 OR EventCode=4625 OR EventCode=644 OR EventCode=529 OR EventCode=675 OR EventCode=676 OR EventCode=681 OR EventCode=4771 OR EventCode=4770 OR EventCode=4768 OR EventCode=4776 OR EventCode=4777 OR EventCode=4725 OR EventCode=4723 OR EventCode=4724 OR EventCode=4767 OR EventCode=4800 OR EventCode=4801)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| eval Account0=mvindex(Account_Name,0) | eval Account1=mvindex(Account_Name,1)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| eval Account=case(EventCode==4624,Account1, EventCode==4625,Account1, EventCode==4648,Account1, EventCode==4722,Account1, EventCode==4723,Account1, EventCode==4724,Account1, EventCode==4725,Account1, EventCode==4738,Account1, EventCode==4740,Account1, EventCode==4767,Account1, EventCode==4768,Account0, EventCode==4769,Account0, EventCode==4771,Account0, EventCode==4770,Account0, EventCode==5140,Account0, EventCode==4778,Account0, EventCode==4779,Account0, EventCode==4800,Account0, EventCode==4801,Account0) | fillnull Value=&amp;#34;-&amp;#34; Account&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| eval ActionBy=case(EventCode==4725,Account0, EventCode==4722,src_user, EventCode==4767,src_user, EventCode==4723,src_user, EventCode==4724,src_user, EventCode==4738,src_user, EventCode==4794,src_user)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| eval Time=strftime(_time, &amp;#34;%m/%d/%y %H:%M:%S&amp;#34;) | sort -_time&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| eval Caller_Machine=if(Caller_Machine_Name!= NULL, Caller_Machine_Name, Caller_Computer_Name) | fillnull Value=&amp;#34;-&amp;#34; Caller_Machine&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| rex field=Process_Name &amp;#34;(?P&amp;lt;Process_Name&amp;gt;[^\\\]+)$&amp;#34; | fillnull Value=&amp;#34;-&amp;#34; Process_Name&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| rex field=Caller_Process_Name &amp;#34;(?P&amp;lt;Caller_Process_Name&amp;gt;[^\\\]+)$&amp;#34; | fillnull Value=&amp;#34;-&amp;#34; Caller_Process_Name&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| rename &amp;#34;Authentication_Package&amp;#34; as &amp;#34;Auth_Package&amp;#34;, &amp;#34;Source_Network_Address&amp;#34; as &amp;#34;Src_Netw_Addr&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| replace &amp;#34;MICROSOFT_AUTHENTICATION_PACKAGE_V1_0&amp;#34; with &amp;#34;MsAuthPkgV1_0&amp;#34; in Auth_Package&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| replace &amp;#34;Microsoft Unified Security Protocol Provider&amp;#34; with &amp;#34;MsUnifiedSecProt&amp;#34; in Auth_Package&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| eval EventCode=case(EventCode==4740, &amp;#34;4740 Locked&amp;#34;, EventCode==4625, &amp;#34;4625 Logon Failed&amp;#34;, EventCode==644, &amp;#34;644 Locked&amp;#34;, EventCode==529, &amp;#34;529 Logon Failed&amp;#34;, EventCode==4768, &amp;#34;4768 Kerb TGT Req&amp;#34;, EventCode==4771, &amp;#34;4771 Kerb Pre-Auth Failed&amp;#34;, EventCode==4770, &amp;#34;4770 Kerb Svc Tkt Renewed&amp;#34;, EventCode==4624, &amp;#34;4624 Logon OK&amp;#34;, EventCode==4648, &amp;#34;4648 Logon Attempt Explicit Creds (ie. Task/RunAs)&amp;#34;, EventCode==4767, &amp;#34;4767 Unlocked&amp;#34;, EventCode==12294, &amp;#34;12294 Potential attack against Administrator&amp;#34;, EventCode==4794, &amp;#34;4794 DSRM Admin PW Set Attempt&amp;#34;, EventCode==4725, &amp;#34;4725 Disabled&amp;#34;, EventCode==4722, &amp;#34;4722 Enabled&amp;#34;, EventCode==4723, &amp;#34;4723 PW change attempt&amp;#34;,EventCode==4724, &amp;#34;4724 PW reset attempt&amp;#34;, EventCode==4738, &amp;#34;4738 Object changed&amp;#34;, EventCode==4720, &amp;#34;4720 Created&amp;#34;, EventCode==4726, &amp;#34;4726 Deleted&amp;#34;, EventCode==4778, &amp;#34;4778 Session Reconnect&amp;#34;, EventCode==4779, &amp;#34;4779 Session Disconnect&amp;#34;, EventCode==4800, &amp;#34;4800 Wks Locked&amp;#34;, EventCode==4801, &amp;#34;4801 Wks Unlocked&amp;#34;, 1=1, EventCode)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| eval Logon_Type=case(Logon_Type==2, &amp;#34;2 Interactive&amp;#34;, Logon_Type==3, &amp;#34;3 Network&amp;#34;, Logon_Type==4, &amp;#34;4 Batch&amp;#34;, Logon_Type==5, &amp;#34;5 Service&amp;#34;, Logon_Type==7, &amp;#34;7 Unlock&amp;#34;, Logon_Type==8, &amp;#34;8 NetworkClearText&amp;#34;, Logon_Type==9, &amp;#34;9 NewCredentials&amp;#34;, Logon_Type==10, &amp;#34;10 RemoteInteractive&amp;#34;, Logon_Type==11, &amp;#34;11 CachedInteractive&amp;#34;, 1=1, Logon_Type)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| table Time, Account, EventCode, ActionBy, Caller_Machine, Failure_Reason, Client_Address, Logon_Type, Logon_Process, Auth_Package, Caller_Process_Name, Process_Name, ComputerName, Workstation_Name, Src_Netw_Addr&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
  </channel>
</rss>
