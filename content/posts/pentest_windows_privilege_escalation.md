+++
title = "Pentest - Windows Privilege Escalation"
author = ["svejk"]
tags = ["serviceAccounts", "privEsc", "privilegeEscalation", "windows"]
draft = false
+++

## From Service to `SYSTEM` {#from-service-to-system}


### Service Account Privileges {#service-account-privileges}

Services can be run such that they don't maintain the privs of `NT AUTHORITY\LOCAL SERVICE` account, eg with the `-k LocalServiceAndNoImpersonation` option.

{{< figure src="/images/impersonate.png" >}}

The task scheduler can be used to restore default privs: [FullPowers](https://github.com/itm4n/FullPowers.git) [itm4n](https://itm4n.github.io/localservice-privileges/). After executing FullPowers:

{{< figure src="/images/fullPowers.png" >}}
